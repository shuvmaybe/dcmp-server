# dcmp-server
This repo contains the guide to run the provided Python server (a Discord bot), how to use the bot, and how to connect it to DCMP.

## IMPORTANT NOTES:
### - This mod CAN and WILL crash your game.
### - This mod CAN and WILL make your options.txt unusable without the mod (back it up, its inside .minecraft)
### - I am NOT responsible for anything bad that happens to your game or your computer.

### To avoid crashing your game, do NOT do these next things:
 - Do NOT make the Render Distance higher than like 50
 - Do NOT make the Max Fps option 0. (it will take infinite time to get to the next frame, Minecraft crashes)
 - and dont be stupid


# Guide
### Prerequisites:
- Python 3
- a Discord account
- friends

How this mod works is through a Discord bot, upon launching the Python script, a local server will go online at `127.0.0.1:5555`, upon joining a world, DCMP will ask if you want to connect to the server.

## Get dumps
**What even are dumps?** Dumps generated by DCMP contain all the options, languages, sound categories, just everything that the mod can set. The bot takes these dumps and then lists the stuff from your dumps upon doing commands like `/listoptions`.


**How do I generate dumps?** Right now, all you need is the mod. You don't need Python or a bot yet. Go on Singleplayer and join any world. You can press 'No' on the DCMP popup. Then you can immediately leave. All the required stuff has been dumped into `.minecraft/config`.

Copy `attributes.json`, `effects.json`, `keys.json`, `languages.json`, `options.json`, and optionally, `soundcategories.json` into any folder. (a soundcategories file with descriptions is available in the repo)

## Combine your obfuscated dump with my deobfuscated dump
Now, Minecraft is a bit stupid. While coding, you are given resources that just deobfuscate every line of code Minecraft has, however, on a normal Minecraft release, all of the normal options like "gamma" get turned to "field_nnnnn" where `n` are numbers, and it changes every version.

To fix that, you will combine your own fielded options.json with my non-field options.json, to make one file that the bot and mod can actually use!

Downloads:
- [combiner.py](https://github.com/shuvmaybe/dcmp-server/blob/main/python/combiner.py)
- [dump folder](https://github.com/shuvmaybe/dcmp-server/tree/main/dumps) (use the version you use)

If you don't have Python installed, [get Python here](https://www.python.org/downloads/).

Put `combiner.py`, your `options.json` and the downloaded `deobfuscated_options.json` into the same folder. Then run `combiner.py` using cmd, like this: `py combiner.py deobfuscated_options.json options.json combined.json` (deobf json, obf json, output file)
(it's recommended you name your output file combined.json since that's what the mod looks for to use)

Now you will have a folder and a combined options file. Inside the folder with your dumps, just drop in your `combined.json`, copy-paste it, rename it to `options.json`, and put your original `combined.json` into `.minecraft/config/`.

## Setting up your Discord bot

I'm actually like so bad at making guides so just [read this instead](https://docs.vectorize.io/build-deploy/external-service-setup/how-to/discord/set-up-a-discord-bot/), thank you

Notes:
- For Gateway intents, you only need the `Message Content Intent`
- On the step where you reset your bot's token, make sure to copy it and save it somewhere
- In OAuth, make sure your bot can read messages, and send embeds, and send messages as well

Now you can download the [the server](https://github.com/shuvmaybe/dcmp-server/tree/main/python/servers) (choose the version that fits your mod version).
Open it and replace the token near the start with your token:
```py
TOKEN = 'your bot token here :3'
```

## Running the bot
Put your `server_x.x.x.py` inside the folder with all the dumped options and the combined `options.json`, and run the server by doing `py server.py`.
If the script immediately crashes, just `pip install` all the packages it asks you to, or download [requirements.txt](https://github.com/shuvmaybe/dcmp-server/blob/main/python/servers/requirements.txt), and write 
```py
pip install -r requirements.txt
```
This will download all the requirements needed. Then run the Python file again.

If everything has been done correctly, your cmd window should be filled with DCMP server logs and the script logging into your bot.

## Connecting to DCMP
Open Minecraft and join a world, you will be prompted whether you want to connect to your Python socket. **(MAKE SURE YOUR BOT IS ONLINE DURING THIS)**

Press 'Yes', and wait for it to connect. It should say in green that you're connected in chat. The bot's status should also update to display there's a connection.

# Using the bot
By writing `/list` in whatever channel the bot is in, you can see everything that can be set. Options, keybinds, attributes, sounds, languages...

## Options
Doing `/listoptions` displays groups. `Bool`, `Int`, `Double`, `Enum`, and one that you can ignore, `Complex`.

Under this line is every option type explained, to list every option under a type, write:
```
/showgroup <kind>
```
With kind as any of the listed options from `/listoptions`.

### Bool
`Bool` can be either `true` or `false`. Which just means "Yes", or "No".
Example:
```
/option name:autoJump value:true
```
This will turn on Auto Jump.

### Int (Integer)
`Int` are just full numbers without decimal points.
Integers are used by options like GUI Scale, Field of View, Max Fps, and Render Distance.

Example:
```
/option name:fov value:20
```
This will make your Field of View 20.

### Double
`Double` are options that use numbers with decimal points.
Such as brightness, expressed as `gamma`.
For the brightness option, 100% is equal to `1`. Making `gamma` 100 will make the in-game brightness 10,000%.

On the other hand, values such as `0.5` will make the brightness 50% in-game.
```
/option name:gamma value:-0.75
```
This example makes brightness -75%.

### Enum
`Enum` options are a bit special than other options. They have multiple options you can set.
We can use the `narrator` enum as an example.
It lists 4 different options: `OFF`, `ALL`, `CHAT`, `SYSTEM`.
Let's turn on the narrator with this command:
```
/option name:narrator value:ALL
```
Enums are different from bools, they only take input of what they listed.

### Complex
`Complex` options cannot be set. There's only one option, which changes the output device for Minecraft.

## Keybinds
You can list settable keybinds by doing `/listkeys`.
Then you can set a key by doing `/keybind <action> <key>`.
Example:
```
/keybind action:key.sneak key:SPACE
```
This will make it so sneaking is triggered by pressing spacebar. The original jumping behaviour is disabled until the original key gets reset to its default value.

## Attributes
Attributes can change the behaviour of Minecraft itself, very different from Minecraft's vanilla effects or similar. You can set things such as how long it takes to break blocks, how long the player will burn, the world's gravity, even the player's scale!
Use `/listattributes` to list all attributes.
Example:
```
/attribute id:scale value:5
```
This will make the player's body 5 times larger.
To reset attributes, simply write `reset` as the value instead of a number.
**Note:** This command requires operator rights.

## Effects
See all effects by writing `/listeffects`. For each effect, there is also a 'Category' sub-description, says whether something is beneficial ~ positive, negative ~ harmful, or even neutral, like in-between.
Every effect is hardcoded to last for 30 seconds, in a later update you will be able to change the duration.
```
/effect id:speed
```
This will give the player Speed for 30 seconds.
**Note:** This command requires operator rights.

## Languages
By writing `/listlanguages`, you can list all available languages in Minecraft. You can then set them using `/lang <code>`. The code is listed in the `ab_cd` format (mostly), displayed above the language's display name.
Note: Every time the language is changed, Minecraft will have to reload resources which just shows the Mojang logo for a few seconds on screen.
```
/lang code:ja_jp
```
This will make the game's language Japanese.

## Sounds
You can also set the volume of every sound category. List them by doing `/listsounds`.
If you used my soundcategories dump, every option will have a description. If you haven't, the descriptions will be blank.
Sounds use the `Double` kind. `1` equals to 100%.
```
/sound id:master volume:2
```
This will make the master volume for Minecraft 200%.

## Other Commands
The provided `server.py` also has a hidden, disabled command, and an additional command.

### `/clientcount`
Displays how many clients are connected to the Python socket. If you've done everything correctly, it should say 1.

### `/broadcastraw`
This command is disabled by default in the provided `server.py` and shouldn't be used by regular users.

When any command that changes something is ran, the bot broadcasts a message to its server, which the Minecraft mod captures.
For effects, the broadcasted message looks something like this:
```
effect speed
```
DCMP parses the broadcasted message, notices the first word is `effect`, and the second word is `speed`, so it automatically applies `minecraft:speed` for 30 seconds.

Using `broadcastraw`, you can broadcast these messages by yourself, although not recommended as the commands already do this for you.

# License
This repository and the DCMP mod project is under the [CC BY-NC 4.0](https://creativecommons.org/licenses/by-nc/4.0/) license.

You may distribute modified copies of the mod and servers, however, original author must be credited.